
<!doctype html>
<html lang="hu" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Tóth Tibor, Simon Gábor">
      
      
        <link rel="canonical" href="https://bmeviaumb11.github.io/skalazhato/homework/03-communication/">
      
      
        <link rel="prev" href="../02-kubernetes/">
      
      
        <link rel="next" href="../pontrendszer/">
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>03 - Kommunikációs megoldások - BMEVIAUMB11 - Skálázható szoftverek</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../extra-material-theme.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#03-kommunikacios-megoldasok" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Élőfej">
    <a href="../.." title="BMEVIAUMB11 - Skálázható szoftverek" class="md-header__button md-logo" aria-label="BMEVIAUMB11 - Skálázható szoftverek" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUMB11 - Skálázható szoftverek
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              03 - Kommunikációs megoldások
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red"  aria-label="Váltás sötét témára"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Váltás sötét témára" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo"  aria-label="Váltás világos témára"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Váltás világos témára" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Keresés">
        
        <button type="reset" class="md-search__icon md-icon" title="Törlés" aria-label="Törlés" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Keresés inicializálása
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bmeviaumb11/skalazhato" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviaumb11/skalazhato
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Lapok" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Skálázható szoftverek

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../information/contributing/" class="md-tabs__link">
          
  
  Tudnivalók

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../01-docker/" class="md-tabs__link">
          
  
  Gyakorlatok / Laborok

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../pontrendszer/" class="md-tabs__link">
          
  
  Nagyházi

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigáció" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BMEVIAUMB11 - Skálázható szoftverek" class="md-nav__button md-logo" aria-label="BMEVIAUMB11 - Skálázható szoftverek" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUMB11 - Skálázható szoftverek
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bmeviaumb11/skalazhato" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    bmeviaumb11/skalazhato
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Skálázható szoftverek
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tudnivalók
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tudnivalók
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/contributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hozzájárulás az anyaghoz
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/GitHub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feladatok beadása (GitHub)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/GitHub-Actions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GitHub Actions ismertető
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/certification/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Megajánlott jegyként elfogadott Microsoft minősítések
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Gyakorlatok / Laborok
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Gyakorlatok / Laborok
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    01 - Konténerizáció
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../02-kubernetes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    02 - Kubernetes, Helm
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    03 - Kommunikációs megoldások
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    03 - Kommunikációs megoldások
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cel" class="md-nav__link">
    <span class="md-ellipsis">
      Cél
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elokovetelmenyek" class="md-nav__link">
    <span class="md-ellipsis">
      Előkövetelmények
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiindulo-projekt" class="md-nav__link">
    <span class="md-ellipsis">
      Kiinduló projekt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0-feladat-elokeszuletek" class="md-nav__link">
    <span class="md-ellipsis">
      0. Feladat - Előkészületek
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-feladat-hibaturo-kommunikacio" class="md-nav__link">
    <span class="md-ellipsis">
      1. Feladat - Hibatűrő kommunikáció
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Feladat - Hibatűrő kommunikáció">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retry" class="md-nav__link">
    <span class="md-ellipsis">
      Retry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-feladat-aszinkron-kommunikacio-rabbitmq-val" class="md-nav__link">
    <span class="md-ellipsis">
      2. Feladat - Aszinkron kommunikáció RabbitMQ-val
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Feladat - Aszinkron kommunikáció RabbitMQ-val">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rabbitmq-beuzemelese" class="md-nav__link">
    <span class="md-ellipsis">
      RabbitMQ beüzemelése
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integracios-esemeny" class="md-nav__link">
    <span class="md-ellipsis">
      Integrációs esemény
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#masstransit-hasznalata" class="md-nav__link">
    <span class="md-ellipsis">
      MassTransit használata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MassTransit használata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kuldo-oldal" class="md-nav__link">
    <span class="md-ellipsis">
      Küldő oldal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fogado-oldal" class="md-nav__link">
    <span class="md-ellipsis">
      Fogadó oldal
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Nagyházi
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Nagyházi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pontrendszer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pontrendszer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mslearning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NHF pontokért elszámolható Azure tananyagok
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cel" class="md-nav__link">
    <span class="md-ellipsis">
      Cél
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elokovetelmenyek" class="md-nav__link">
    <span class="md-ellipsis">
      Előkövetelmények
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kiindulo-projekt" class="md-nav__link">
    <span class="md-ellipsis">
      Kiinduló projekt
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0-feladat-elokeszuletek" class="md-nav__link">
    <span class="md-ellipsis">
      0. Feladat - Előkészületek
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-feladat-hibaturo-kommunikacio" class="md-nav__link">
    <span class="md-ellipsis">
      1. Feladat - Hibatűrő kommunikáció
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Feladat - Hibatűrő kommunikáció">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retry" class="md-nav__link">
    <span class="md-ellipsis">
      Retry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-feladat-aszinkron-kommunikacio-rabbitmq-val" class="md-nav__link">
    <span class="md-ellipsis">
      2. Feladat - Aszinkron kommunikáció RabbitMQ-val
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. Feladat - Aszinkron kommunikáció RabbitMQ-val">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rabbitmq-beuzemelese" class="md-nav__link">
    <span class="md-ellipsis">
      RabbitMQ beüzemelése
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integracios-esemeny" class="md-nav__link">
    <span class="md-ellipsis">
      Integrációs esemény
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#masstransit-hasznalata" class="md-nav__link">
    <span class="md-ellipsis">
      MassTransit használata
    </span>
  </a>
  
    <nav class="md-nav" aria-label="MassTransit használata">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#kuldo-oldal" class="md-nav__link">
    <span class="md-ellipsis">
      Küldő oldal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fogado-oldal" class="md-nav__link">
    <span class="md-ellipsis">
      Fogadó oldal
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/bmeviaumb11/skalazhato/edit/master/docs/homework/03-communication/index.md" title="Oldal szerkesztése" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  


<h1 id="03-kommunikacios-megoldasok">03 - Kommunikációs megoldások<a class="headerlink" href="#03-kommunikacios-megoldasok" title="Permanent link">&para;</a></h1>
<h2 id="cel">Cél<a class="headerlink" href="#cel" title="Permanent link">&para;</a></h2>
<p>A házi feladat célja az elosztott alkalmazások fejlesztése során felmerülő megoldások alapszintű gyakorlása.</p>
<h2 id="elokovetelmenyek">Előkövetelmények<a class="headerlink" href="#elokovetelmenyek" title="Permanent link">&para;</a></h2>
<ul>
<li>REST webszolgáltatások készítésének ismerete .NET platformon<ul>
<li>A házi külön nem tér ki a REST szerű webszolgáltatások készítésének módszereire, arra a BSc szakirányos képzés <a href="https://bmeviauac01.github.io/datadriven/hu/">Adatvezérelt rendszerek</a> és a <a href="https://bmeviauav23.github.io/aspnetcorebook/">Szoftverfejlesztés .NET platformra</a> című választható tárgy anyagai az ajánlott irodalom.</li>
</ul>
</li>
<li>Docker Desktop</li>
<li>Visual Studio 2022<ul>
<li>kidolgozva: v17.11.4</li>
<li>ASP.NET and web development workload</li>
</ul>
</li>
<li>Házi repóban található kiinduló projekt</li>
</ul>
<h2 id="kiindulo-projekt">Kiinduló projekt<a class="headerlink" href="#kiindulo-projekt" title="Permanent link">&para;</a></h2>
<p>A kiinduló projekt egy .NET 8 alapú alkalmazás két mikroszolgáltatást tartalmaz:</p>
<ul>
<li><strong>Catalog</strong>: egy egyszerű REST webszolgáltatás, ami termékeket listáz egy memóriában tárolt listából, de szándékosan véletlenszerűen 503-as hibakóddal tér vissza.</li>
<li><strong>Order</strong>: egy egyszerű REST webszolgáltatás, ami használja a Catalog szolgáltatást<ul>
<li>A REST-es végpont elérését a hívó oldalon OpenAPI leíróból generált kliens oldali osztályokon keresztül érjük el. (lásd VS / Order projekt / Connected Services / Manage Connected Services / swagger Client).</li>
<li>Ez a kliens oldali kód <code>HttpClient</code> segítségével hívja meg a Catalog szolgáltatást.</li>
</ul>
</li>
<li><strong>AppHost</strong>: .NET Aspire alapó AppHost projekt, ami megkönnyíti az elosztott alkalmazások futtatását fejlesztés során. 
  Koncepciójában a Docker Compose-hoz hasonló, de C# nyelven írható YAML helyett, és nem csak .NET alkalmazásokat támogat.<ul>
<li>biztosítja a komponensek megfigyelhetőségét OpenTelemetry segítségével (Struktúrált naplózás, Nyomkövetés, Metrikák)</li>
<li>és a Service Discovery-t konfigurációk kezelésén keresztül</li>
<li>Bővebben az Aspire-ről: <a href="https://learn.microsoft.com/en-us/dotnet/aspire/get-started/aspire-overview">https://learn.microsoft.com/en-us/dotnet/aspire/get-started/aspire-overview</a></li>
</ul>
</li>
</ul>
<h2 id="0-feladat-elokeszuletek">0. Feladat - Előkészületek<a class="headerlink" href="#0-feladat-elokeszuletek" title="Permanent link">&para;</a></h2>
<ol>
<li>Vedd fel a gyökérben lévő neptun.txt-be a NEPTUN azonosítódat.</li>
<li>Írd át az <em>AppHost</em> projekt <code>Program.cs</code> fájljában a sztringekben található <code>NEPTUN</code> kifejezést a saját neptun kódodra.</li>
<li>Írd át az <em>Order</em> projektben a <code>Program.cs</code> fájljában a sztringekben található <code>NEPTUN</code> kifejezést a saját neptun kódodra.</li>
<li><strong>Próbáljuk ki</strong> az alkalmazásokat az <em>AppHost</em> projektet futtatva.<ol>
<li>Megjelenik-e a .NET Aspire dashboard?</li>
<li>Működnek-e a szolgáltatások külön külön a swagger felületükről?</li>
</ol>
</li>
</ol>
<h2 id="1-feladat-hibaturo-kommunikacio">1. Feladat - Hibatűrő kommunikáció<a class="headerlink" href="#1-feladat-hibaturo-kommunikacio" title="Permanent link">&para;</a></h2>
<p>A hibatűrő kommunikáció kapcsán tárgyalt tervezési minták nem csak a kommunikáció implementációja során hasznosak, hanem bármilyen olyan komponens hívása során is, ami nem várt tranziens hibajelenséget produkálhat.
Tény, hogy leggyakrabban egy távoli hívás kommunikációja során történhet ilyen, így ott mindenképpen érdemes a hibatűrést valamilyen módon megvalósítani.</p>
<p>A laborfeladat során két ASP.NET Core mikroszolgáltatás közötti REST-es kommunikációt szeretnénk hibatűrőbbé tenni.
Ehhez .NET 8-ban már beépített lehetőségek vannak, amik a <a href="https://github.com/App-vNext/Polly">Polly</a> osztálykönyvtárra támaszkodik, ami a leggyakoribb hibatűrő mintákat valósítja meg, nekünk csak felkonfigurálnunk kell.
Az egyszerűség kedvéért most a Retry mintát valósítsuk meg.</p>
<h3 id="retry">Retry<a class="headerlink" href="#retry" title="Permanent link">&para;</a></h3>
<p>Az Order szolgáltatásból hívjuk a Catalog szolgáltatást, hogy lekérjük a termékek listáját.
A Catalog szolgáltatás azonban (szándékosan) véletlenszerűen 503 HTTP hibakóddal tér vissza.
Célunk, hogy a hívásokat újrapróbálkozással kezeljük, és a hívó számára transzparens legyen az újrapróbálkozás.</p>
<p><strong>Próbáljuk ki</strong> a jelenlegi működést az Order szolgáltatás swagger oldaláról, és figyeljük meg a hibát, amit a Catalog szolgáltatás ad vissza.</p>
<p>.NET-ben a HTTP kéréseket a <code>HttpClient</code> osztály segítségével végezzük. Az <code>IHttpClientFactory</code> segítségével tudjuk konfigurálni a <code>HttpClient</code>-ünket, ahol már az alap beállításokon felül hibatűrést megvalósító handlert is konfigurálni tudunk.</p>
<p>Az <em>Order</em> szolgáltatás <code>Program</code> osztályában konfiguráljuk be az <code>HttpClient</code>-ünket a <code>AddResilienceHandler</code> függvény segítségével, és adjuk hozzá a retry konfigurációt az alábbi követelmények szerint:</p>
<ul>
<li>Az 503-as hibakód esetén próbálkozzon újra</li>
<li>Maximum 5-ször próbálkozzon újra</li>
<li>Újrapróbálkozás előtt várjon 1 másodpercet</li>
<li>Többszöri újrapróbálkozási idő exponenciálisan növekvő időköz legyen</li>
</ul>
<p><strong>Próbáljuk ki!</strong> Tapasztalatunk szerint szinte megszűntek a hibák.</p>
<p>Ez a Policy gyakorlatilag beépül a <code>HttpClient</code> Handler Pipeline-jába, így a hívó számára transzparens lesz az újrapróbálkozási logika. Viszont érdemes odafigyelni a <code>HttpClient</code> <code>Timeout</code>jára is, mert az újrapróbálkozások során így az nem indul újra.</p>
<details class="tip">
<summary>Beépített alapértelmezett konfiguráció</summary>
<p>.NET 8 óta kapunk egy akapértelmezett konfigurációt is a leggyakoribb esetekre, amit az <code>AddStandardResilienceHandler</code> metódussal tudunk hozzáadni a HttpClientFactory-hoz. Sőt ez már alapértelmezetten az Aspire segédprojektben be is volt regisztrálva, de a mai példában ezt szándékosan nem használtuk, hogy lássuk hogyan kellene ezt kézzel konfigurálni.</p>
<div class="highlight"><span class="filename">Skalazhato.HF3.ServiceDefaults/Extensions.cs</span><pre><span></span><code><span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">ConfigureHttpClientDefaults</span><span class="p">(</span><span class="n">http</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="c1">// Turn on resilience by default</span>
</span><span class="hll"><span class="w">    </span><span class="c1">// http.AddStandardResilienceHandler();</span>
</span>
<span class="w">    </span><span class="c1">// Turn on service discovery by default</span>
<span class="w">    </span><span class="n">http</span><span class="p">.</span><span class="n">AddServiceDiscovery</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div>
<p>Bővebben: <a href="https://devblogs.microsoft.com/dotnet/building-resilient-cloud-services-with-dotnet-8/">https://devblogs.microsoft.com/dotnet/building-resilient-cloud-services-with-dotnet-8/</a></p>
</details>
<div class="admonition note">
<p class="admonition-title">Polly általánosan</p>
<p>A Polly-t nem csak <code>HttpClient</code>-tel lehet használni, hanem tetszőleges kódban: össze lehet rakni egy Policy láncot, és abba beburkolni a kívánt függvényhívást. A Policy-ket akár karbantarthatjuk a DI konténerben is.</p>
</div>
<p>Most laboron nem nézünk példát több Policy használatára, de szóba jöhetne még a Timeout, a Circuit breaker, Cache vagy akár a Fallback policy <a href="https://github.com/App-vNext/Polly/blob/master/README.md">is</a>.
Az előadás anyagban találtok egy összetettebb szekvencia diagrammot, az ajánlott összetételről.</p>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy <code>f1.png</code>-t, amiben látszik a .NET Aspire dashboardon a Trace fülön a retry policy hatása a hívásokra. A hívások között legyenek sikeres és sikertelen hívások is, és látszódjon, hogy a sikertelen hívások újrapróbálkozásokkal sikeresekké válnak.</p>
</div>
<h2 id="2-feladat-aszinkron-kommunikacio-rabbitmq-val">2. Feladat - Aszinkron kommunikáció RabbitMQ-val<a class="headerlink" href="#2-feladat-aszinkron-kommunikacio-rabbitmq-val" title="Permanent link">&para;</a></h2>
<p>A feladat egy esemény alapú aszinkron kommunikáció megvalósítása.
Az <em>Order</em> szolgáltatás fog publikálni egy <code>OrderCreated</code> integrációs eseményt, amit egy üzenetsorba rak.
Erre tetszőleges szolgáltatás feliratkozhat és reagálhat rá.
Esetünkben a <em>Catalog</em> szolgáltatás fogja a megrendelt termék raktárkészletét csökkenteni.
Most az egyszerűség kedvéért ne foglalkozzunk az idempotens megvalósítással.</p>
<p>Az aszinkron kommunikációt RabbitMQ-n keresztül valósítjuk meg, és a MassTransit osztálykönyvtár magas szintű absztrakciójával fedjük el az alacsonyszintű kommunikációs részleteket.</p>
<h3 id="rabbitmq-beuzemelese">RabbitMQ beüzemelése<a class="headerlink" href="#rabbitmq-beuzemelese" title="Permanent link">&para;</a></h3>
<p>A .NET Aspire segítségével <em>AppHost</em> projektbe vegyünk fel egy RabbitMQ erőforrást.</p>
<p>Ehhez az alábbi NuGet csomagot kell felvenni.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;PackageReference</span><span class="w"> </span><span class="na">Include=</span><span class="s">&quot;Aspire.Hosting.RabbitMQ&quot;</span><span class="w"> </span><span class="na">Version=</span><span class="s">&quot;8.2.1&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</code></pre></div>
<p>Vegyük fel a RabbitMQ-t az <em>AppHost</em> projektbe, és a függőségeket erre az új erőforrásra.</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="kt">var</span><span class="w"> </span><span class="n">messaging</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="n">AddRabbitMQ</span><span class="p">(</span><span class="s">&quot;hf3-NEPTUN-messaging&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="w">    </span><span class="p">.</span><span class="n">WithManagementPlugin</span><span class="p">();</span>
</span>
<span class="kt">var</span><span class="w"> </span><span class="n">catalog</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="n">AddProject</span><span class="o">&lt;</span><span class="n">Projects</span><span class="p">.</span><span class="n">Skalazhato_HF3_Services_Catalog</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;hf3-NEPTUN-catalog&quot;</span><span class="p">)</span>
<span class="hll"><span class="w">    </span><span class="p">.</span><span class="n">WithReference</span><span class="p">(</span><span class="n">messaging</span><span class="p">);</span>
</span>
<span class="kt">var</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">builder</span><span class="p">.</span><span class="n">AddProject</span><span class="o">&lt;</span><span class="n">Projects</span><span class="p">.</span><span class="n">Skalazhato_HF3_Services_Order</span><span class="o">&gt;</span><span class="p">(</span><span class="s">&quot;hf3-NEPTUN-order&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">.</span><span class="n">WithReference</span><span class="p">(</span><span class="n">catalog</span><span class="p">)</span>
<span class="hll"><span class="w">    </span><span class="p">.</span><span class="n">WithReference</span><span class="p">(</span><span class="n">messaging</span><span class="p">);</span>
</span></code></pre></div>
<p>Ez a megoldás a RabbitMQ-t egy Docker konténerben fogja futtatni.
A RabbitMQ-hoz kapunk így egy menedzsment felületet is, amit a <code>guest</code> userrel, és egy generált jelszóval tudunk elérni.
A jelszó megtalálható az Aspire Dashboardon a RabbitMQ erőforrás részletes nézeténél.</p>
<h3 id="integracios-esemeny">Integrációs esemény<a class="headerlink" href="#integracios-esemeny" title="Permanent link">&para;</a></h3>
<p>Létre kell hozzuk az eseményt reprezentáló üzenetet, ami lényegében a kommunikáció szerződése lesz.</p>
<ol>
<li>
<p>Hozzunk létre egy új .NET 8 Class Library projektet <code>Skalazhato.HF3.Events</code> néven.</p>
</li>
<li>
<p>Ebbe vegyünk fel egy interfészt <code>IOrderCreatedEvent</code> néven az alábbi tartalommal, ami azt üzenetsorban lévő adatot reprezentálja.</p>
<ul>
<li>Megrendelt termék azonosítója</li>
<li>Megrendelés ideje</li>
<li>Megrendelt mennyiség</li>
</ul>
</li>
<li>
<p>Az <em>Order</em> és <em>Catalog</em> szolgáltatásokban vegyük fel a <code>Skalazhato.HF3.Events</code> projekt referenciáját, és implementáljuk az interfészt, új <code>IntegrationEvents</code> mappákban.</p>
</li>
</ol>
<p>Semmi bonyolultra nem kell eddig gondolni, ezek csak egyszerű DTO osztályok.</p>
<h3 id="masstransit-hasznalata">MassTransit használata<a class="headerlink" href="#masstransit-hasznalata" title="Permanent link">&para;</a></h3>
<p>Az üzeneteket a MassTransit könyvtár segítségével fogjuk elküldeni és fogadni.</p>
<h4 id="kuldo-oldal">Küldő oldal<a class="headerlink" href="#kuldo-oldal" title="Permanent link">&para;</a></h4>
<p>Kezdjük a a küldő oldallal.</p>
<ol>
<li>
<p>Vegyük fel az <em>Order</em> szolgáltatásba a következő NuGet csomagot.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;PackageReference</span><span class="w"> </span><span class="na">Include=</span><span class="s">&quot;MassTransit.RabbitMQ&quot;</span><span class="w"> </span><span class="na">Version=</span><span class="s">&quot;8.2.5&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</code></pre></div>
</li>
<li>
<p>Konfiguráljuk be a <code>Program</code> osztályban a MassTransit-ot, hogy RabbitMQ-t használjon.</p>
<div class="highlight"><pre><span></span><code><span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddMassTransit</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="p">.</span><span class="n">UsingRabbitMq</span><span class="p">((</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">config</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">config</span><span class="p">.</span><span class="n">Host</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="n">GetRequiredService</span><span class="o">&lt;</span><span class="n">IConfiguration</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="n">GetConnectionString</span><span class="p">(</span><span class="s">&quot;hf3-NEPTUN-messaging&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
</li>
<li>
<p>Süssük el az eseményt a <code>TestController</code>-ben, egy újonnan létrehozott <code>CreateOrder</code> actionben.</p>
<ul>
<li>Az action-t nem fontos parametrizálni, dolgozhat beégetett értékekkel is.</li>
<li>A küldést a <code>IPublishEndpoint</code> objektum segítségével végezzük el. 
  MassTransit esetében a <code>Publish</code> süti el a broadcast szerű eseményeket, míg a <code>Send</code> inkább a command típusú üzenetekre van kihegyezve.</li>
<li>Naplózzuk <strong>struktúráltan</strong> az <code>ILogger</code> segítségével infó szinten, hogy melyik terméket rendeltük meg mekkora mennyiségben.</li>
<li>Az action végén adjunk vissza egy <code>Ok</code> státuszkódot, és egy üzenetet a válaszban, hogy sikeres volt a megrendelés.</li>
</ul>
</li>
</ol>
<h4 id="fogado-oldal">Fogadó oldal<a class="headerlink" href="#fogado-oldal" title="Permanent link">&para;</a></h4>
<p>Térjünk át a fogadó oldalra.</p>
<ol>
<li>
<p>A <em>Catalog</em> szolgáltatás projektbe vegyük fel szintén az alábbi NuGet csomagot.</p>
<div class="highlight"><pre><span></span><code><span class="nt">&lt;PackageReference</span><span class="w"> </span><span class="na">Include=</span><span class="s">&quot;MassTransit.RabbitMQ&quot;</span><span class="w"> </span><span class="na">Version=</span><span class="s">&quot;8.2.5&quot;</span><span class="w"> </span><span class="nt">/&gt;</span>
</code></pre></div>
</li>
<li>
<p>Szükségünk lesz egy az eseményt lekezelő osztályra is, aminek a MassTransit-os <code>IConsumer&lt;T&gt;</code> interfészt kell megvalósítania.</p>
<ul>
<li>Vegyünk fel a Catalog projektbe egy <code>IntegrationEventHandlers</code> mappát, majd abba hozzunk létre egy új osztályt <code>OrderCreatedEventHandler</code> néven.</li>
<li>Itt a kapott adatok alapján frissítsük az adatainkat: a mi Móricka példánkban a <code>ProductController</code>-ben lévő statikus listán dolgozunk. 
 Nem kell most törődni az idempotens megvalósítással, azaz azzal, hogy többszöri üzenetküldés esetén ne legyen dupla módosítás.</li>
<li>Naplózzunk <strong>struktúráltan</strong> az <code>ILogger</code> segítségével infó szinten, hogy melyik termék raktárkészletét csökkentettük, és mennyi lett az új.</li>
</ul>
</li>
<li>
<p>Konfiguráljuk be a <code>Program.cs</code>-ben a MassTransit-ot, hogy RabbitMQ-t használjon, illetve hogy az <code>IOrderCreatedEvent</code> eseményünket melyik <code>IConsumer</code> megvalósítás kezelje le.</p>
<div class="highlight"><pre><span></span><code><span class="n">builder</span><span class="p">.</span><span class="n">Services</span><span class="p">.</span><span class="n">AddMassTransit</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">x</span><span class="p">.</span><span class="n">AddConsumer</span><span class="o">&lt;</span><span class="n">OrderCreatedEventHandler</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">    </span><span class="n">x</span><span class="p">.</span><span class="n">UsingRabbitMq</span><span class="p">((</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">cfg</span><span class="p">)</span><span class="w"> </span><span class="o">=&gt;</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="n">cfg</span><span class="p">.</span><span class="n">Host</span><span class="p">(</span><span class="n">ctx</span><span class="p">.</span><span class="n">GetRequiredService</span><span class="o">&lt;</span><span class="n">IConfiguration</span><span class="o">&gt;</span><span class="p">()</span>
<span class="w">            </span><span class="p">.</span><span class="n">GetConnectionString</span><span class="p">(</span><span class="s">&quot;hf3-NEPTUN-messaging&quot;</span><span class="p">));</span>
<span class="w">        </span><span class="n">cfg</span><span class="p">.</span><span class="n">ConfigureEndpoints</span><span class="p">(</span><span class="n">ctx</span><span class="p">);</span>
<span class="w">    </span><span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
</li>
<li>
<p><strong>Próbáljuk ki!</strong></p>
<ul>
<li>Kérjük le a termékeket</li>
<li>Süssünk el swaggerből a <code>POST /api/Test/CreateOrder</code> kérést</li>
<li>Nézzük meg, hogy frissült-e a termék raktárkészlete.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Hibakeresés</p>
<p>Ha nem frissült, akkor a logokból vagy a rabbitmq menedzsment felületéről lehet nyomozni.</p>
<ul>
<li>Ha azt tapasztaljuk hogy nem tud csatlakozni valamelyik szolgáltatás, akkor ellenőrizzük az Aspire AppHost projektet és a Connection Stringeket.</li>
<li>Ha azt tapasztaljuk, hogy <code>skipped</code> üzenetsorba kerülnek az üzenetek, akkor a küldő oldal rendben működött, de valamiért a fogadó oldal nem tudott a megadott üzenettípusra egyszer sem feliratkozni helyesen.</li>
</ul>
</div>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy <code>f2.png</code>-t, amiben látszik a .NET Aspire dashboardon a <em>Structured</em> fülön a küldő és fogadó oldali logbejegyzések.</p>
</div>
<details class="note">
<summary>Kitekintés</summary>
<ol>
<li>
<p>A fenti példában nem törődtünk az idempotens megvalósítással, ez mindig külön tervezést igényel, az üzleti logikánk függvényében, de mindenképpen érdemes a tervezés során figyelni erre.</p>
</li>
<li>
<p>Mi most broadcast jellegű integrációs eseményt sütöttünk el.
   Ne feledjünk van ennek egy másik variánsa is, amikor command szerű üzenetet küldünk egy másik szolgáltatásnak, és ott elvárjuk az esemény lefutását.
   Integrációs esemény során a fogadó félre van bízva, hogy mit kezd a kapott információval.</p>
</li>
<li>
<p>A MassTransit egy nagyon sokoldalú eszköz, ami nem csak RabbitMQ-val használható, hanem más üzenetsorokkal is, mint például Azure Service Bus, vagy akár In-Memory üzenetsorral is tesztelhető.</p>
</li>
</ol>
</details>
  <hr>
  <div class="md-source-file">
    <span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg
          xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
          </path>
        </svg>
      </span>
      <span title="2024. október 5. 22:09:00">
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago"><span class="timeago" datetime="2024-10-05T22:09:00+02:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date">2024-10-05</span>
      </span>
    </span>

    

    <span class="md-source-file__fact">
      <span class="md-icon" title="Szerzők">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path
            d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
          </path>
        </svg>
      </span>
      <span>Szerzők</span>
      <nav></nav>      
    </span>
  </div>




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Vissza a tetejére
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; BME VIK AUT
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.top", "search.suggest", "content.action.edit", "toc.follow", "content.code.copy"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>