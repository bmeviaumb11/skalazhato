<!DOCTYPE html><html lang="hu" class="no-js"><head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Tóth Tibor, Simon Gábor">
      
      
        <link rel="canonical" href="https://bmeviaumb11.github.io/skalazhato/homework/02-kubernetes/">
      
      
        <link rel="prev" href="../01-docker/">
      
      
        <link rel="next" href="../03-communication/">
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>02 - Kubernetes, Helm, Traefik - BMEVIAUMB11 - Skálázható szoftverek</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/timeago.css">
    
      <link rel="stylesheet" href="../../extra-material-theme.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"><script src="../../assets/javascripts/glightbox.min.js"></script><style id="glightbox-style">
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            .gscrollbar-fixer { padding-right: 15px; }
            .gdesc-inner { font-size: 0.75rem; }
            body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color); }
            body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color); }
            body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color); }
        </style></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#02-kubernetes-helm-traefik" class="md-skip">
          Kihagyás
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Élőfej">
    <a href="../.." title="BMEVIAUMB11 - Skálázható szoftverek" class="md-header__button md-logo" aria-label="BMEVIAUMB11 - Skálázható szoftverek" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BMEVIAUMB11 - Skálázható szoftverek
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              02 - Kubernetes, Helm, Traefik
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="aut" data-md-color-primary="aut" data-md-color-accent="red" aria-label="Váltás sötét témára" type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Váltás sötét témára" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5"></path></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="indigo" aria-label="Váltás világos témára" type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Váltás világos témára" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9z"></path></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Keresés" placeholder="Keresés" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
      </label>
      <nav class="md-search__options" aria-label="Keresés">
        
        <button type="reset" class="md-search__icon md-icon" title="Törlés" aria-label="Törlés" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Keresés inicializálása
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bmeviaumb11/skalazhato" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
  </div>
  <div class="md-source__repository">
    bmeviaumb11/skalazhato
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Lapok" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Skálázható szoftverek

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../information/contributing/" class="md-tabs__link">
          
  
  
  Tudnivalók

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../01-docker/" class="md-tabs__link">
          
  
  
  Kisházi

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../pontrendszer/" class="md-tabs__link">
          
  
  
  Nagyházi

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigáció" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="BMEVIAUMB11 - Skálázható szoftverek" class="md-nav__button md-logo" aria-label="BMEVIAUMB11 - Skálázható szoftverek" data-md-component="logo">
      
  <img src="../../logo-bme-aut.png" alt="logo">

    </a>
    BMEVIAUMB11 - Skálázható szoftverek
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bmeviaumb11/skalazhato" title="Főoldalra ugrás" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
  </div>
  <div class="md-source__repository">
    bmeviaumb11/skalazhato
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Skálázható szoftverek
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2">
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tudnivalók
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tudnivalók
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hozzájárulás az anyaghoz
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/GitHub/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Feladatok beadása (GitHub)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/GitHub-Actions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GitHub Actions ismertető
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/certification/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Megajánlott jegyként elfogadott Microsoft minősítések
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../information/zv/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Záróvizsga tételsor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Kisházi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Kisházi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../01-docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    01 - Konténerizáció
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    02 - Kubernetes, Helm, Traefik
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    02 - Kubernetes, Helm, Traefik
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cel" class="md-nav__link">
    <span class="md-ellipsis">
      Cél
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elokovetelmenyek" class="md-nav__link">
    <span class="md-ellipsis">
      Előkövetelmények
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elokeszulet" class="md-nav__link">
    <span class="md-ellipsis">
      Előkészület
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Előkészület">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git-repository-letrehozasa-es-letoltese" class="md-nav__link">
    <span class="md-ellipsis">
      Git repository létrehozása és letöltése
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      0. Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="0. Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elokeszulet-docker-desktop-on" class="md-nav__link">
    <span class="md-ellipsis">
      Előkészület Docker Desktop-on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubectl-csatlakozas-a-klaszterhez" class="md-nav__link">
    <span class="md-ellipsis">
      Kubectl csatlakozás a klaszterhez
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      1. Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#podok-es-nevterek-listazasa" class="md-nav__link">
    <span class="md-ellipsis">
      Podok és névterek listázása
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pod-letrehozasa-yaml-leiroval" class="md-nav__link">
    <span class="md-ellipsis">
      Pod létrehozása YAML leíróval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      2 Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-deployment-letrehozasa" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Deployment létrehozása
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-deployment-frissitese" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Deployment frissítése
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      3. Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#celok" class="md-nav__link">
    <span class="md-ellipsis">
      Célok
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#30-helm" class="md-nav__link">
    <span class="md-ellipsis">
      3.0 Helm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-ingress-controller-api-gateway-telepitese-helm-charttal" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Ingress Controller (api gateway) telepítése Helm charttal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-adatbazisok-telepitese" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Adatbázisok telepítése
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-alkalmazasunk-telepitese" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Alkalmazásunk telepítése
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-ingress-szabalyok" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Ingress szabályok
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      4. Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#helm-chart-keszitese" class="md-nav__link">
    <span class="md-ellipsis">
      Helm chart készítése
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-communication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    03 - Kommunikációs megoldások
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../04-aks/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    04 - Azure Kubernetes Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../05-azurescale/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    05 - Skálázás Azure-ban
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../06-serverless/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    06 - Serverless
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4">
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Nagyházi
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Nagyházi
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pontrendszer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Pontrendszer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mslearning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NHF pontokért elszámolható Azure tananyagok
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tartalomjegyzék">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tartalomjegyzék
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#cel" class="md-nav__link">
    <span class="md-ellipsis">
      Cél
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elokovetelmenyek" class="md-nav__link">
    <span class="md-ellipsis">
      Előkövetelmények
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#elokeszulet" class="md-nav__link">
    <span class="md-ellipsis">
      Előkészület
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Előkészület">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#git-repository-letrehozasa-es-letoltese" class="md-nav__link">
    <span class="md-ellipsis">
      Git repository létrehozása és letöltése
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#0-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      0. Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="0. Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#elokeszulet-docker-desktop-on" class="md-nav__link">
    <span class="md-ellipsis">
      Előkészület Docker Desktop-on
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kubectl-csatlakozas-a-klaszterhez" class="md-nav__link">
    <span class="md-ellipsis">
      Kubectl csatlakozás a klaszterhez
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      1. Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#podok-es-nevterek-listazasa" class="md-nav__link">
    <span class="md-ellipsis">
      Podok és névterek listázása
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pod-letrehozasa-yaml-leiroval" class="md-nav__link">
    <span class="md-ellipsis">
      Pod létrehozása YAML leíróval
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      2 Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-deployment-letrehozasa" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 Deployment létrehozása
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-deployment-frissitese" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 Deployment frissítése
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      3. Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#celok" class="md-nav__link">
    <span class="md-ellipsis">
      Célok
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#30-helm" class="md-nav__link">
    <span class="md-ellipsis">
      3.0 Helm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-ingress-controller-api-gateway-telepitese-helm-charttal" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Ingress Controller (api gateway) telepítése Helm charttal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-adatbazisok-telepitese" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Adatbázisok telepítése
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-alkalmazasunk-telepitese" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Alkalmazásunk telepítése
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-ingress-szabalyok" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 Ingress szabályok
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-feladat" class="md-nav__link">
    <span class="md-ellipsis">
      4. Feladat
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Feladat">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#helm-chart-keszitese" class="md-nav__link">
    <span class="md-ellipsis">
      Helm chart készítése
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/bmeviaumb11/skalazhato/edit/master/docs/homework/02-kubernetes/index.md" title="Oldal szerkesztése" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
    </a>
  
  


<h1 id="02-kubernetes-helm-traefik">02 - Kubernetes, Helm, Traefik<a class="headerlink" href="#02-kubernetes-helm-traefik" title="Permanent link">¶</a></h1>
<h2 id="cel">Cél<a class="headerlink" href="#cel" title="Permanent link">¶</a></h2>
<p>A labor célja:</p>
<ul>
<li>megismerni a Kubernetes használatának alapjait<ul>
<li>a <em>podok</em>, <em>Deployment-ek</em> és <em>ReplicaSet-ek</em> létrehozását és kezelését,</li>
<li>a leggyakrabban használt <code>kubectl</code> parancsokat.</li>
</ul>
</li>
<li>egy alkalmazás telepítése Kubernetes klaszterbe és a frissítés módjának megismerése.<ul>
<li>A telepítéshez és frissítéshez részben Helm chartot, részben magunk által elkészített YAML erőforrás leírókat használunk.</li>
</ul>
</li>
</ul>
<h2 id="elokovetelmenyek">Előkövetelmények<a class="headerlink" href="#elokovetelmenyek" title="Permanent link">¶</a></h2>
<p>A labor Windows platformon lett kidolgozva, de Linuxon is hasonlóan működik.</p>
<ul>
<li>Kubernetes<ul>
<li>Bármely felhő platform által biztosított klaszter</li>
<li>Linux platformon: <a href="https://kubernetes.io/docs/start">minikube</a></li>
<li>Windows platformon: Docker Desktop</li>
</ul>
</li>
<li><a href="https://kubernetes.io/docs/tasks/tools/">kubectl</a><ul>
<li>A binárisa legyen elérhető PATH-on.</li>
</ul>
</li>
<li>Egy kubernetes-t menedzselni képes GUI, például:<ul>
<li><a href="https://marketplace.visualstudio.com/items?itemName=ms-kubernetes-tools.vscode-kubernetes-tools">VS Code Kubernetes extension</a></li>
<li><a href="https://k8slens.dev/">Lens</a></li>
<li><a href="https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/">Kubernetes Dashboard</a></li>
<li><a href="https://www.jetbrains.com/help/rider/Kubernetes.html">Rider</a> - hallgatói fiókkal ingyenes</li>
<li><a href="https://k9scli.io/">k9s</a></li>
</ul>
</li>
<li>Helm CLI<ul>
<li><a href="https://helm.sh/docs/intro/install/">Helm</a></li>
<li>A Helm CLI legyen elérhető PATH-on.</li>
</ul>
</li>
</ul>
<h2 id="elokeszulet">Előkészület<a class="headerlink" href="#elokeszulet" title="Permanent link">¶</a></h2>
<p>A feladatok megoldása során ne felejtsd el követni a feladat beadás folyamatát <a href="../../information/GitHub/">GitHub</a>.</p>
<h3 id="git-repository-letrehozasa-es-letoltese">Git repository létrehozása és letöltése<a class="headerlink" href="#git-repository-letrehozasa-es-letoltese" title="Permanent link">¶</a></h3>
<ol>
<li>Moodle-ben keresd meg a laborhoz tartozó meghívó URL-jét és annak segítségével hozd létre a saját repository-dat.</li>
<li>Várd meg, míg elkészül a repository, majd checkout-old ki.</li>
<li>Hozz létre egy új ágat <code>megoldas</code> néven, és ezen az ágon dolgozz.</li>
<li>A <code>neptun.txt</code> fájlba írd bele a Neptun kódodat. A fájlban semmi más ne szerepeljen, csak egyetlen sorban a Neptun kód 6 karaktere.</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">NEPTUN</p>
<p><img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2757.svg" title=":exclamation:"> A feladatokban a <code>neptun</code> kifejezés helyett a saját neptunkódunkat helyettesítsük be minden esetben <img alt="❗" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2757.svg" title=":exclamation:"></p>
</div>
<h2 id="0-feladat">0. Feladat<a class="headerlink" href="#0-feladat" title="Permanent link">¶</a></h2>
<h3 id="elokeszulet-docker-desktop-on">Előkészület Docker Desktop-on<a class="headerlink" href="#elokeszulet-docker-desktop-on" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>Praktikus, ha leállítunk minden futó konténert, amire nincs szükségünk. Használhatjuk a következő parancsot PowerShell-ben:</p>
<div class="highlight"><pre><span></span><code><span class="n">docker</span> <span class="nb">rm </span><span class="o">-f</span> <span class="p">$(</span><span class="n">docker</span> <span class="nb">ps </span><span class="n">-aq</span><span class="p">)</span>
</code></pre></div>
</li>
<li>
<p>Nyissuk meg a Docker Desktop beállításait.</p>
</li>
<li>
<p>A <em>Kubernetes</em> fülön pipáljuk be az <em>Enable Kubernetes</em> opciót, és kattintsunk az <em>Apply</em>-ra.</p>
</li>
<li>
<p>Várjuk meg, amíg befejeződik a művelet. A kubernetes alrendszer elindulása néhány percet is igénybe vehet.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/docker-kubernetes-enable.png" data-desc-position="bottom"><img alt="docker kubernetes enable" src="images/docker-kubernetes-enable.png"></a></p>
</li>
</ol>
<h3 id="kubectl-csatlakozas-a-klaszterhez">Kubectl csatlakozás a klaszterhez<a class="headerlink" href="#kubectl-csatlakozas-a-klaszterhez" title="Permanent link">¶</a></h3>
<ul>
<li>
<p>Ellenőrizzük, hogy a <code>kubectl</code> bináris elérhető-e, és tud-e csatlakozni a klaszterhez:</p>
<div class="highlight"><pre><span></span><code>kubectl version
</code></pre></div>
<p>A <code>kubectl</code> a CLI kliens a klaszter kezeléséhez (ejtsd: cube control).
A Kubernetes API szerveréhez csatlakozik, annak REST API-ján keresztül végzi a műveleteket.
Láthatjuk mind a kliens, mind a klaszter verzió információit.</p>
</li>
<li>
<p>A <code>kubectl</code> egy konkrét klaszterhez csatlakozik. Nézzük meg, milyen klasztereket ismer:</p>
<div class="highlight"><pre><span></span><code>kubectl config get-contexts
</code></pre></div>
</li>
<li>
<p>Ha több klaszterrel dolgoznánk, itt láthatnánk őket.</p>
</li>
<li>Ezek valójában egy konfigurációs fájlban vannak: <code>%userprofile%/.kube/config</code></li>
<li>Váltani a <code>kubectl config use-context &lt;név&gt;</code> parancssal lehet.</li>
<li>Minden parancsnál külön megadhatjuk a kontextust a <code>--context</code> kapcsolóval, de inkább az implicit contextust szoktuk használni.</li>
<li>Kontextus beállításról részletesebben <a href="https://kubernetes.io/docs/reference/kubectl/cheatsheet/#kubectl-context-and-configuration">itt</a>.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Kubernetes GUI</p>
<p>A feladatokban lévő műveletek szinte mindegyike elvégezhető a GUI (pl.: VS Code kubernetes kiegészítő) segítségével is. A labor leírásaiban a <code>kubectl</code> parancsokat fogjuk használni, de a GUI is használható.</p>
</div>
<h2 id="1-feladat">1. Feladat<a class="headerlink" href="#1-feladat" title="Permanent link">¶</a></h2>
<h3 id="podok-es-nevterek-listazasa">Podok és névterek listázása<a class="headerlink" href="#podok-es-nevterek-listazasa" title="Permanent link">¶</a></h3>
<ul>
<li>
<p>Listázzuk ki a futó podokat:</p>
<div class="highlight"><pre><span></span><code>kubectl get pod -A
</code></pre></div>
<p>A <code>-A</code> vagy <code>--all-namespaces</code> kapcsoló az összes névtérben levő podot listázza.</p>
</li>
<li>
<p>Ismételjük meg a <code>-A</code> kapcsoló nélkül:</p>
<div class="highlight"><pre><span></span><code>kubectl get pod
</code></pre></div>
<p>Ez az alapértelmezett <em>default</em> névtér podjait listázza. (Az alapértelmezett névtér is a kontextus beállítása.)</p>
</li>
<li>
<p>Nézzük meg, milyen névterek vannak: <code>kubectl get namespace</code></p>
</li>
<li>
<p>Listázzuk a podokat egy konkrét névtérben: <code>kubectl get pod -n kube-system</code></p>
</li>
</ul>
<h3 id="pod-letrehozasa-yaml-leiroval">Pod létrehozása YAML leíróval<a class="headerlink" href="#pod-letrehozasa-yaml-leiroval" title="Permanent link">¶</a></h3>
<p>Kubernetes erőforrásokat tipikusan YAML leírókban definiálunk. A futtatás elemi egysége a pod, így készítsünk egy YAML fájlt a podunkhoz és indítsuk el azt.</p>
<div class="admonition tip">
<p>A leíró szerkesztéséhez használhatjuk például Visual Studio Code-ot. Érdemes olyan szövegszerkesztővel dolgozni, amely ismeri a YAML szintaktikát. A parancsok futtatásához használhatjuk például <a href="https://code.visualstudio.com/docs/terminal/basics">Visual Studio Code beépített terminálját</a>.</p>
</div>
<ol>
<li>
<p>Hozzunk létre egy új YAML fájt a repositorynk gyökerébe <code>createpod.yml</code> néven, az alábbi követelmények mentén</p>
<ul>
<li>a kubernetes leíró Pod-ot definiál</li>
<li>a pod neve legyen <code>counter-neptun</code> a <strong>saját neptunkóddal</strong> kiegészítve</li>
<li>a pod egy konténert tartalmazzon, amely az <code>ubuntu</code> képből indul</li>
<li>a konténer egy bash parancsot futtasson, ami kiírja a <em>NEPTUN</em> kódodat és 5 másodpercenként kiírja az aktuális időt.</li>
</ul>
</li>
<li>
<p>A konzolunkban navigáljunk el abba a könyvtárba, ahol a YAML fájl van, majd hozzuk létre a podot:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f createpod.yml
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">apply vs create</p>
<p>A <code>create</code> helyett <code>apply</code> parancsot használjuk. Az apply létrehozza, ha nem létezik, és módosítja az erőforrást, ha már létezik.</p>
</div>
</li>
<li>
<p>A pod létrejött. Ellenőrizzük:</p>
<div class="highlight"><pre><span></span><code>kubectl get pod
</code></pre></div>
</li>
<li>
<p>Nézzük meg a pod logjait:</p>
<div class="highlight"><pre><span></span><code>kubectl logs counter-neptun
</code></pre></div>
<div class="admonition tip">
<p>Ha gondoljuk, tegyük hozzá a <code>-f</code> kapcsolót is (<code>kubectl logs -f counter</code>) a log követéséhez. <span class="keys"><kbd class="key-control">Ctrl</kbd><span>+</span><kbd class="key-c">C</kbd></span>-vel léphetünk ki a log folyamatos követéséből. Ne feledjük, hogy ez nem a pod terminálja, hanem a logjainak figyelését.</p>
</div>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>A feladathoz tartozó forráskódot commitold be és készíts egy képernyőképet (<code>f1.1.png</code>), majd commitold azt be a házi feladat repó gyökerébe, amin a futó pod logjai látszanak.</p>
</div>
<ol>
<li>
<p>Töröljük a podot:</p>
<div class="highlight"><pre><span></span><code>kubectl delete pod counter-neptun
</code></pre></div>
</li>
<li>
<p>Ellenőrizzük, hogy a pod tényleg eltűnik egy kis idő múlva:</p>
<div class="highlight"><pre><span></span><code>kubectl get pod
</code></pre></div>
<div class="admonition note">
<p>A pod törlése nem azonnali. A benne futó konténerek leállás jelzést kapnak, és ők maguk terminálhatnak. Ha ez nem történik, meg, akkor kis idő múlva megszünteti őket a rendszer.</p>
</div>
</li>
</ol>
<details class="tip">
<summary>Interaktív shell</summary>
<p>Ha szeretnénk egy podban belépni, és ott dolgozni, akkor ezt a <code>kubectl exec</code> paranccsal tehetjük meg. Például:</p>
<div class="highlight"><pre><span></span><code>kubectl exec -it &lt;podnév&gt; /bin/bash
</code></pre></div>
<p>A <code>-it</code> kapcsolók interaktív módot és terminált biztosítanak. A <code>/bin/bash</code> a shell, amit futtatni szeretnénk.</p>
<p>Ahogy a docker-nél már láthattuk, egy új shell indul a pod konténerében, és ehhez csatlakozunk.
Ebben a shellben, ahogy natív docker esetében is, bármit megtehetünk.</p>
</details>
<h2 id="2-feladat">2 Feladat<a class="headerlink" href="#2-feladat" title="Permanent link">¶</a></h2>
<h3 id="21-deployment-letrehozasa">2.1 Deployment létrehozása<a class="headerlink" href="#21-deployment-letrehozasa" title="Permanent link">¶</a></h3>
<p>A podokat nem szoktuk közvetlenül létrehozni, hanem <em>Deployment</em>-re és <em>ReplicaSet</em>-re szoktunk bízni a kezelésüket és létrehozásukat.</p>
<ol>
<li>
<p>Hozzunk létre egy új YAML fájlt <code>createdeployment.yml</code> néven az alábbi követelményeknek megfelelően:</p>
<ul>
<li>a kubernetes leíró Deployment-et definiál</li>
<li>a deployment neve legyen <code>counter-neptun</code> a <strong>saját neptunkóddal</strong> kiegészítve</li>
<li>a deployment egy olyan konténert definiáljon, mint az 1. feladatban</li>
<li>1 replika legyen az elvárt állapot</li>
<li>a selectorok használata során <code>counter-app-neptun</code> címkét használjuk a <strong>saját neptunkóddal</strong> kiegészítve</li>
</ul>
</li>
<li>
<p>Hozzuk létre a Deployment-et:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f createdeployment.yml
</code></pre></div>
</li>
<li>
<p>Listázzuk a Deployment-eket, ReplicaSet-eket és a podokat:</p>
<div class="highlight"><pre><span></span><code>kubectl get deployment
kubectl get replicaset
kubectl get pod
</code></pre></div>
<p>Vegyük észre, hogy a pod neve generált, a <em>Deployment</em> és a <em>ReplicaSet</em> alapján kap automatikusan egyet.</p>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy képernyőképet (<code>f2.1.png</code>) és commitold azt be a házi feladat repó gyökerébe, amin a futó deployment, replicaset és pod neve látszik.
Commitold be a forráskódot is.</p>
</div>
<h3 id="22-deployment-frissitese">2.2 Deployment frissítése<a class="headerlink" href="#22-deployment-frissitese" title="Permanent link">¶</a></h3>
<p>A <em>Deployment</em> szolgál az alkalmazás verziónak frissítésére, kiadására.</p>
<p>Változtassuk meg a program futását a deployment leíróján keresztül: ne 5, hanem 10 másodpercenként írjuk ki az időt.
Ezt a <em>Deployment</em> módosításával érhetjük el, mivel podot nem tudunk szerkeszteni hatékonyan, egy futó pod nem cserélhető le.
Ehelyett valójában egy új podot kell létrehozni indirekt módon a deployment frissítésével.</p>
<p>Érvényesítsd a módosítást a deployment leíróban, majd alkalmazd a változást:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f createdeployment.yml
</code></pre></div>
<p>Kérjük le a logokat a deployment podjából:</p>
<div class="highlight"><pre><span></span><code>kubectl logs -f &lt;podnév&gt;
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy képernyőképet (<code>f2.2.png</code>) és commitold azt be a házi feladat repó gyökerébe, ahol a logokban már 10 másodpercenként történik a kiíratás.</p>
</div>
<details class="tip">
<summary>Kubectl parancsok</summary>
<p>A <code>kubectl</code> leggyakrabban használt parancsainak szerkezete: <code>kubectl &lt;ige&gt; &lt;erőforrás&gt; &lt;attribútumok&gt;</code>.</p>
<p>Az ige például:</p>
<ul>
<li><code>get</code>: listázza az erőforrásokat</li>
<li><code>create</code>: létrehoz egy erőforrást</li>
<li><code>delete</code>: töröl egy erőforrást</li>
<li><code>describe</code>: lekérdezi az erőforrás részletes állapotát</li>
<li><code>edit</code>: letölti az erőforrás leíróját, és megnyitja szövegszerkesztőben; mentés és bezárás után frissíti a klaszterben az erőforrást a módosítások alapján</li>
</ul>
<p>Az erőforrások a <code>pod</code>, <code>replicaset</code> vagy röviden <code>rs</code>, a <code>deployment</code>, stb.</p>
<p>A parancsokról <code>-h</code> kapcsolóval kaphatunk segítséget, pl. <code>kubectl describe -h</code></p>
</details>
<h2 id="3-feladat">3. Feladat<a class="headerlink" href="#3-feladat" title="Permanent link">¶</a></h2>
<h3 id="celok">Célok<a class="headerlink" href="#celok" title="Permanent link">¶</a></h3>
<p>A célunk a kiinduló repóban lévő (<code>storeapp</code> mappa), megrendeléseket kezelő konténeralapú, külön álló (mikro)szolgáltatásokra épülő webalkalmazás telepítése Kubernetes-be. Forrás: <a href="https://github.com/Azure-Samples/aks-store-demo">https://github.com/Azure-Samples/aks-store-demo</a></p>
<p>A rendszer az alábbit komponensekből áll:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/k8s.drawio.png" data-desc-position="bottom"><img alt="TODO" src="images/k8s.drawio.png"></a></p>
<table>
<thead>
<tr>
<th>Szolgáltatás</th>
<th>Leírás</th>
</tr>
</thead>
<tbody>
<tr>
<td>mongodb</td>
<td>MongoDB példány az adatok tárolásához</td>
</tr>
<tr>
<td>rabbitmq</td>
<td>RabbitMQ a megrendelési üzenetsorhoz</td>
</tr>
<tr>
<td>makeline-service</td>
<td>Ez a szolgáltatás kezeli a rendelések feldolgozását (üzenetsorból) és perzisztálását (db-be) (Golang)</td>
</tr>
<tr>
<td>order-service</td>
<td>Ez a szolgáltatás a rendelések leadására szolgál, ami az üzenetsorba küld üzeneteket (Javascript)</td>
</tr>
<tr>
<td>product-service</td>
<td>Ez a szolgáltatás a termékek CRUD műveleteit végzi memóriában, perzisztens tár nélkül (Rust)</td>
</tr>
<tr>
<td>store-front</td>
<td>Webalkalmazás, amelyen keresztül a vásárlók rendeléseket adhatnak le (Vue.js)</td>
</tr>
<tr>
<td>store-admin</td>
<td>Webalkalmazás, amelyet az üzlet dolgozói használnak a sorban lévő rendelések megtekintésére és a termékek kezelésére (Vue.js)</td>
</tr>
<tr>
<td>traefik</td>
<td>API gateway és Ingress Controller</td>
</tr>
<tr>
<td>virtual-customer</td>
<td>Ütemezetten szimulálja a rendelés létrehozását (Rust)</td>
</tr>
<tr>
<td>virtual-worker</td>
<td>Ütemezetten szimulálja a rendelés teljesítését (Rust)</td>
</tr>
</tbody>
</table>
<p>Feladatunk a következő:</p>
<ol>
<li>Telepítsük a Traefik api gateway-t Helm chart-tal.</li>
<li>Telepítsük a MongoDB és RabbitMQ komponenseket YAML leírókkal.</li>
<li>Telepítsük az alkalmazásunk saját komponenseit YAML leírókkal.</li>
<li>Hozzuk létre az Ingress szabályokat, hogy a Traefik tudja, hova továbbítsa a bejövő kéréseket.</li>
<li>Ellenőrizzük, hogy minden szolgáltatás elérhető-e a Traefik-en keresztül.</li>
</ol>
<h3 id="30-helm">3.0 Helm<a class="headerlink" href="#30-helm" title="Permanent link">¶</a></h3>
<p>Ellenőrizzük, hogy a <code>helm</code> CLI elérhető-e:</p>
<div class="highlight"><pre><span></span><code>helm version
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Helm 3</p>
<p>A feladat során a Helm 3-as verzióját fogjuk használni. A korábbi verziója koncepcióban azonos, de működésében eltérő.</p>
</div>
<h3 id="31-ingress-controller-api-gateway-telepitese-helm-charttal">3.1 Ingress Controller (api gateway) telepítése Helm charttal<a class="headerlink" href="#31-ingress-controller-api-gateway-telepitese-helm-charttal" title="Permanent link">¶</a></h3>
<p>A Traefik-et <a href="https://github.com/traefik/traefik-helm-chart">Helm charttal</a> fogjuk telepíteni, mert a Traefik helyes működéséhez a Traefik konténer (Deployment) mellett egyéb <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/">CRD</a> elemekre is szükség lesz a konfigurációhoz.</p>
<div class="admonition warning">
<p class="admonition-title">Chart-ok ellenőrzése</p>
<p>A Helm chartok nagy része harmadik féltől származik, így a klaszterünbe való telepítés előtt a tartalmukat érdemes alaposan megnézni.</p>
</div>
<ol>
<li>
<p>A Helm is repository-kkal dolgozik, ahonnan a chart-okat letölti. Ezeket regisztrálni kell. Regisztráljuk a Traefik hivatalos chart-ját tartalmazó repository-t, majd frissítsük az elérhető char-okat:</p>
<div class="highlight"><pre><span></span><code>helm repo add traefik https://traefik.github.io/charts
helm repo update
</code></pre></div>
</li>
<li>
<p>Telepítsük:</p>
<div class="highlight"><pre><span></span><code>helm install traefik traefik/traefik --set ports.web.nodePort=32080 --set service.type=NodePort --set "additionalArguments={--api.insecure=true}"
</code></pre></div>
<ul>
<li>A legelső <code>traefik</code> a Helm release nevét adja meg. Ezzel tudunk rá hivatkozni a jövőben.</li>
<li>A <code>traefik/traefik</code> azonosítja a telepítendő chartot (repository/chartnév).</li>
<li>A <code>--set</code> kapcsolóval a chart változóit állítjuk be.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Publikus eléréshez</p>
<p>A Traefik jelen konfigurációban <em>NodePort</em> service típussal van konfigurálva, ami azt jelenti, lokálisan, helyben a megadott porton lesz csak elérhető. Ha publikusan elérhető klaszterben dolgozunk, akkor tipikusan <em>LoadBalancer</em> service típust fogunk kérni, hogy publikus IP címet is kapjon a Traefik.</p>
<p>Továbbá itt az alapértelmezett 80-as port helyett a 32080-as portot használjuk, hogy ne ütközzön a gépünkön esetlegesen futó egyéb szolgáltatásokkal.
Így a klaszterünk belépési pontja a <a href="http://localhost:32080">http://localhost:32080</a> címen lesz elérhető.</p>
</div>
</li>
<li>
<p>Ellenőrizzük, hogy fut-e:</p>
<div class="highlight"><pre><span></span><code>kubectl get pod
</code></pre></div>
<p>Látunk kell egy traefik kezdetű podot.</p>
</li>
<li>
<p>A Traefik dashboard-ja nem elérhető "kívülről".
   A dashboard segít minket látni a Traefik konfigurációját és működését.
   Mivel ez a klaszter belső állapotát publikálja, production üzemben valamilyen módon authentikálnunk kellene.
   Ezt most megkerülve <code>kubectl</code> segítségével egy helyi portra továbbítjuk a Traefik dashboard-ot (és a telepítéskor insecure módba kapcsoltuk).
   A port átirányítást próbáljuk most a VSCode Kubernetes extension segítségével:</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/traefik-dashboard-port-forward.png" data-desc-position="bottom"><img alt="Traefik port forward" src="images/traefik-dashboard-port-forward.png"></a></p>
<p>Fogadjuk el az alapértelmezett értékeket (<code>9100:metrics 8080:traefik 8000:web 8443:websecure</code>). Így a Traefik dashboard a <a href="http://localhost:8080/dashboard">http://localhost:8080/dashboard</a> címen lesz elérhető.</p>
<details class="tip">
<summary>Port forward parancs</summary>
<p>Ahogy látjuk a GUI-s K8S eszközök is csak a <code>kubectl port-forward</code> parancsot használják a háttérben.</p>
<p>Ha nem használunk GUI-t, akkor a port forward parancs a következő, amibe ráadásul nem égettük bele a pod nevét:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>port-forward<span class="w"> </span><span class="k">$(</span>kubectl<span class="w"> </span>get<span class="w"> </span>pods<span class="w"> </span>--selector<span class="w"> </span><span class="s2">"app.kubernetes.io/name=traefik"</span><span class="w"> </span>--output<span class="o">=</span>name<span class="k">)</span><span class="w"> </span><span class="m">9100</span>:9100<span class="w"> </span><span class="m">8080</span>:8080<span class="w"> </span><span class="m">8000</span>:8000<span class="w"> </span><span class="m">8443</span>:8443<span class="w"> </span>-n<span class="w"> </span>default
</code></pre></div>
</details>
</li>
<li>
<p>Nézzük meg a Traefik dashboardot: <a href="http://localhost:8080/dashboard/">http://localhost:8080/dashboard/</a></p>
</li>
</ol>
<div class="admonition note">
<p>Ha frissíteni szeretnénk később a Traefik-et, akkor azt a <code>helm upgrade traefik traefik/traefik ...</code> paranccsal tudjuk megtenni.</p>
</div>
<h3 id="32-adatbazisok-telepitese">3.2 Adatbázisok telepítése<a class="headerlink" href="#32-adatbazisok-telepitese" title="Permanent link">¶</a></h3>
<p>Az adatbázisainkat a már megírt YAML leírókkal telepítjük. Ez a leíró fájl már rendelkezésünkre áll a kiinduló repository <code>storeapp</code> almappájában.</p>
<ol>
<li>
<p>Vizsgáljuk meg a repository <code>storeapp/hf-kubernetes/db</code> könyvtárában lévő YAML leírókat.</p>
<ul>
<li>MongoDB: StatefulSet-ként telepítjük, és a perzisztens adattároláshoz dinamikus PersistentVolumeClaim-et használunk</li>
<li>RabbitMQ: StatefulSet-ként telepítjük, és a perzisztens adattároláshoz dinamikus PersistentVolumeClaim-et használunk</li>
</ul>
</li>
<li>
<p>Telepítsük az adatbázisokat:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f storeapp/hf-kubernetes/db
</code></pre></div>
<div class="admonition tip">
<p>A <code>kubectl apply</code> parancs <code>-f</code> kapcsolója ha mappát kap, akkor a mappában lévő összes yaml fájlt alkalmazza.</p>
</div>
</li>
<li>
<p>Ellenőrizzük, hogy az adatbázis podok elindulnak-e (pl.: GUI-val). Minden a <em>default</em> névtérbe kellett települjön.</p>
</li>
</ol>
<h3 id="33-alkalmazasunk-telepitese">3.3 Alkalmazásunk telepítése<a class="headerlink" href="#33-alkalmazasunk-telepitese" title="Permanent link">¶</a></h3>
<p>Az alkalmazásunk telepítéséhez szintén YAML leírókat találunk a <code>storeapp/hf-kubernetes/app</code> könyvtárban.</p>
<ol>
<li>
<p>Nézzük meg a leírókat.</p>
</li>
<li>
<p>Telepítsük az alkalmazásokat:</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f storeapp/hf-kubernetes/app
</code></pre></div>
</li>
<li>
<p>Ellenőrizzük, hogy létrejöttek a Deployment-ek podok. A <em>store-front</em> és <em>store-admin</em> podoknak nem fognak tudni elindulni, mert a leíró olyan (lokális) image-eket használnak, amelyek nincsenek lebuildelve a gépünkön. A többi szolgáltatás esetében egy távoli publikus konténer registry-ből húzza le a szükséges image-eket.</p>
</li>
<li>
<p>Ezeket az image-eket az <code>storeapp/src/store-admin</code> és <code>storeapp/src/store-front</code> könyvtárban tudjuk lebuildelni. Nyissunk egy új terminál ablakot, navigáljunk el a <code>storeapp</code> megfelelő könyvtárába, és futtassuk a <code>docker build</code> parancsokat:</p>
<div class="highlight"><pre><span></span><code>cd storeapp/src/store-front
docker build -t store-front:local .
cd ../store-admin
docker build -t store-admin:local .
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Pod újraindítása</p>
<p>Ha nem akarjuk kivárni az rendszer általi újraindítást töröljük ki a pod-ot kézzel, aminek hatására a deployment létrehoz egy új pod-ot, ami már a helyi image-t fogja használni.</p>
</div>
<details class="tip">
<summary>Ha mégsem zöldülnek ki</summary>
<ol>
<li>
<p>Egyes Linuxos gépeken nem vállnak alapvetően láthatóvá a minikube-on belül az image-ek. Az ilyen gépeken érdemes a következő parancs előtt az <code>eval $(minikube docker-env)</code> parancsot kiadni.
Ezt követően ebben a terminál ablakban adjuk ki az image build paracsomat, valamint a k8s apply parancsokat is.</p>
</li>
<li>
<p>Ugyanez Windows-os + minikube powershellel:
Lehet, hogy nem a minikube-ban vannak a docker image-ek. Ekkor PowerShellben a <code>&amp; minikube -p minikube docker-env --shell powershell | Invoke-Expression</code> paranccsal tudod elérni, hogy a minikube-ban lévő docker daemont használd.
Ha ez a parancs <code>❌  Exiting due to MK_USAGE: the docker-env command only supports the docker and containerd runtimes</code> errort dobna: Add ki a <code>minikube delete</code> parancsot, majd indítsd el a következő módon: <code>minikube start --driver=docker --container-runtime=docker</code></p>
</li>
</ol>
</details>
</li>
<li>
<p>Mivel még nincs ingress szabály ezért próbáljuk ki port forwarddal a <code>store-front</code> szolgáltatást a 3000-es porton. Az oldal betölt, de nem éri el a <code>product-service</code> szolgáltatást, mert nincs ingress szabály.</p>
</li>
</ol>
<h3 id="34-ingress-szabalyok">3.4 Ingress szabályok<a class="headerlink" href="#34-ingress-szabalyok" title="Permanent link">¶</a></h3>
<p>Az alkalmazásunkban még nincsenek ingress szabályok, ezért az Ingress Controller (most a Traefik) nem tudja, hogy a bejövő kéréseket hova kell továbbítani.
Hozzuk létre ezeket a szabályokat, kezdjük az mikroszolgáltatásokkal.</p>
<ol>
<li>
<p>A <code>storeapp/hf-kubernetes/app</code> könyvtárban módosítsuk a <code>product-service.yaml</code> fájlt, és adjuk hozzá a következő Ingress erőforrást:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">products</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app.kubernetes.io/name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">products</span>
<span class="w">    </span><span class="nt">storedemo.tier</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">backend</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">traefik.ingress.kubernetes.io/router.entrypoints</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">web</span>
<span class="w">    </span><span class="nt">traefik.ingress.kubernetes.io/router.middlewares</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">product-stripprefix@kubernetescrd</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/api/products</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">product-service</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3002</span>
</code></pre></div>
<p>Van viszont egy probléma: a <code>product-service</code> szolgáltatás nem a <code>/api/products</code> útvonalon várja a kéréseket, hanem a <code>/</code> útvonalon.
A <code>/api/products</code> útvonalat csak a frontend ismeri.
Ezt a problémát a Traefik <em>middleware</em> funkciójával tudjuk megoldani.
A middleware-ek a Traefik-ben olyan komponensek, amelyek a bejövő kéréseket módosítják, mielőtt továbbítanák azokat a backend szolgáltatások felé.
A Traefik-ben van egy <em>StripPrefix</em> middleware, amely eltávolítja a megadott prefixet a kérés URL-jéből.
Ezt a middleware-t kell alkalmaznunk a <code>products</code> Ingress-re.</p>
</li>
<li>
<p>A <code>product-service.yaml</code> fájlban definiáljuk a middleware CRD erőforrást az Ingress szabályunk előtt:</p>
<div class="highlight"><pre><span></span><code><span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">traefik.io/v1alpha1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Middleware</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">product-stripprefix</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">stripPrefix</span><span class="p">:</span>
<span class="w">    </span><span class="nt">prefixes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/api/products</span>
</code></pre></div>
</li>
<li>
<p>A <code>product-service.yaml</code> fájlban adjuk hozzá a következő részt az Ingress erőforráshoz, az <code>annotations</code> szekcióba:</p>
<div class="highlight"><pre><span></span><code><span class="nt">annotations</span><span class="p">:</span>
<span class="w">  </span><span class="nt">traefik.ingress.kubernetes.io/router.middlewares</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default-product-stripprefix@kubernetescrd</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Namespace</p>
<p>A middleware neve tartalmazza a névteret is: <code>namespace-product-stripprefix@kubernetescrd</code></p>
</div>
</li>
<li>
<p>Érvényesítsük a módosítást.</p>
<div class="highlight"><pre><span></span><code>kubectl apply -f storeapp/hf-kubernetes/app
</code></pre></div>
</li>
<li>
<p>Nyissuk meg a Traefik dashboardját és vizsgáljuk meg a konfigurált végpontot, majd próbáljuk ki a működését a <a href="http://localhost:32080/api/products">http://localhost:32080/api/products</a> címen.</p>
<p><a class="glightbox" data-type="image" data-width="auto" data-height="auto" href="images/traefik-products.png" data-desc-position="bottom"><img alt="Traefik products" src="images/traefik-products.png"></a></p>
</li>
<li>
<p>Hasonlóan adjuk hozzá az Ingress szabályokat és a szükséges middleware-eket a <code>order-service.yaml</code> és a <code>makeline-service.yaml</code> fájlokhoz is.
   Mind a két esetben a szolgáltatások a <code>/</code> gyökér útvonalon várják a kéréseket, míg az Ingress szabályokban a <code>/api/orders</code> és <code>/api/makeline</code> útvonalakat kell használni.</p>
</li>
<li>
<p>Vegyük fel a publikus frontend szolgáltatás Ingress szabályát is a <code>store-web.yaml</code> fájlba.
   <strong>Itt nem szükséges a middleware</strong>, mert a frontend szolgáltatás a <code>/</code> gyökér útvonalon várja a kéréseket az ingress-en keresztül is és a webszervben is.</p>
</li>
<li>
<p>Vegyük fel az admin frontend szolgáltatás Ingress szabályát is az <code>store-admin.yaml</code> fájlba.
   Az ingress-t úgy konfiguráljuk fel, hogy a <code>/admin</code> útvonalra érkező kéréseket továbbítsa a <code>store-admin</code> szolgáltatás <code>/</code> útvonalára.</p>
</li>
<li>
<p>Érvényesítsük a módosításokat, és próbáljuk ki az alkalmazásunkat a <a href="http://localhost:32080">http://localhost:32080</a> és a <a href="http://localhost:32080/admin">http://localhost:32080/admin</a> címen. A tesztelendő funkciókat az alábbi Beadandó részben találhatod.</p>
</li>
</ol>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts az alábbi tesztesetekről képernyőképeket, és commitold be a házi feladat repó gyökerébe:</p>
<ul>
<li>Admin felület<ul>
<li>Az admin felületen megjelennek a termékek a <em>Products</em> menüpont alatt. (<code>f3.4.1.png</code>)</li>
<li>Az <em>Edit</em> gombra kattintva módosítsuk a termék nevét, hogy tartalmazza a NEPTUN kódunkat, majd mentsük el és nézzük meg a változást a listában. (<code>f3.4.2.png</code>)</li>
</ul>
</li>
<li>Publikus oldal<ul>
<li>A főoldalon megjelennek a termékek (a NEPTUN kódunkat tartalmazó is). (<code>f3.4.3.png</code>)</li>
<li>Egy NEPTUN kódot tartalmazó termék kiválasztásával a termék részletei is megjelennek. (<code>f3.4.4.png</code>)</li>
<li>Az <em>Add to cart</em> gombra kattintva a termék bekerül a kosárba.</li>
<li>A <em>Cart</em> szövegre kattintva megjelenik a kosár tartalma. (<code>f3.4.5.png</code>)</li>
<li>A <em>Proceed to checkout</em> gombra kattintva a rendelés elküldhető (sikeres üzenet). (<code>f3.4.6.png</code>)</li>
</ul>
</li>
<li>Admin felület<ul>
<li>Az <em>Orders</em> menüpont alatt megjelennek a beérkezett (friss) rendelések.</li>
<li>A megrendelésre kattintva megjelennek a rendelés részletei, ami tartalmazza a NEPTUN kódunkat is. (<code>f3.4.7.png</code>)</li>
<li>A <em>Complete Order</em> gombra kattintva az állapot módosítás sikeres a rendelés állapota <em>Completed</em>-re változik. (<code>f3.4.8.png</code>)</li>
</ul>
</li>
</ul>
</div>
<h2 id="4-feladat">4. Feladat<a class="headerlink" href="#4-feladat" title="Permanent link">¶</a></h2>
<p>Helm chartot eddig meglévő komponensek paraméterezhető telepítésére használtunk. Készítsünk most mi Helm chartot a <em>virtual-customer</em> és <em>virtual-worker</em> szolgáltatások paraméterezhető telepítéséhez.</p>
<h3 id="helm-chart-keszitese">Helm chart készítése<a class="headerlink" href="#helm-chart-keszitese" title="Permanent link">¶</a></h3>
<ol>
<li>
<p>Hozzuk létre a repository-nkban a <code>/storeapp/helmchart</code> mappát majd a konzolban navigáljunk oda.</p>
</li>
<li>
<p>Készítsünk egy új, üres chart-ot, az alábbi paranccsal, ami létrehoz egy <em>storeapp</em> nevű chartot egy azonos nevű könyvtárban.</p>
<div class="highlight"><pre><span></span><code>helm create storeapp
</code></pre></div>
</li>
<li>
<p>Nézzük meg a chart fájljait.</p>
<ul>
<li><code>Chart.yaml</code> a metaadatokat írja le.</li>
<li><code>values.yaml</code> írja le a változóink alapértelmezett értékeit.</li>
<li><code>.helmignore</code> azon fájlokat listázza, amelyeket a chart értelmezésekor nem kell figyelembe venni.</li>
<li><code>templates</code> könyvtárban vannak a template fájlok, amik a generálás alapjául szolgálnak.</li>
</ul>
<p>A Helm egy olyan template nyelvet használ, amelyben változó behelyettesítések, ciklusok, egyszerű szövegműveletek támogatottak.</p>
</li>
<li>
<p>Töröljük ki a <code>templates</code> könyvtárból az összes fájlt a <code>_helpers.tpl</code> kivételével. Töröljük ki a <code>values.yaml</code> fájlból is a tartalmat.</p>
</li>
<li>
<p>Másoljuk be a <code>storeapp/hf-kubernetes/simulation</code> mappából a <code>virtual-customer.yaml</code> és <code>virtual-worker.yaml</code> fájlokat a <code>templates</code> könyvtárba.</p>
</li>
<li>
<p>Módosítsuk a fenti két yaml leírót a következő követelmények szerint a helm szintaktika használatával:</p>
<ul>
<li>Az erőforrások metaadatai (pl. <code>metadata.name</code>, <code>selector.matchLabels.app</code>, <code>containers.name</code>, <code>template.metadata.labels.app</code>) tartalmazzák a <code>neptun</code> kódunkat pl.: <code>virtual-customer-neptun</code>, ebből a neptun kódot a <code>values.yaml</code> fájlban definiált <code>neptun</code> változóból helyettesítsük be.</li>
<li>A deployment leírók legyen feltételesen végrehajtva, tehát csak akkor jöjjenek létre az erőforrások, ha a <code>values.yaml</code> fájlban a <code>virtualCustomer.enabled</code> illetve <code>virtualWorker.enabled</code> értéke true.</li>
<li>A <code>virtualCustomer</code> és <code>virtualWorker</code> pod-ok  <code>ORDERS_PER_HOUR</code> környezeti változóji legyenek paraméterezhetőek a <code>values.yaml</code> fájlban a <code>virtualCustomer.ordersPerHour</code> és <code>virtualWorker.ordersPerHour</code> változójával.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Helm template szintaktika</p>
<p>A Helm template szintaktikájáról részletesen olvashatsz <a href="https://helm.sh/docs/chart_template_guide/">itt</a>.</p>
</div>
</li>
<li>
<p>Nézzük meg a template-eket kiértékelve.</p>
</li>
<li>
<p>Lépjünk vissza a <code>storeapp/helmchart</code> könyvtárba:</p>
</li>
<li>
<p>Futtassuk le csak a template generálást a telepítés nélkül:</p>
<div class="highlight"><pre><span></span><code>helm install storeapp --debug --dry-run storeapp
</code></pre></div>
</li>
<li>
<p>A release-nek <em>storeapp</em> nevet választottunk. Ez a Helm release azonosítója.</p>
</li>
<li>
<p>Konzolra megkapjuk a kiértékelt YAML-öket. Ellenőrizzük a kimenetben, hogy a rendben behelyettesítődtek-e.</p>
</li>
<li>
<p>Telepítsük az alkalmazás komponenseit a chart segítségével:</p>
<div class="highlight"><pre><span></span><code>helm upgrade storeapp --install storeapp
</code></pre></div>
<ul>
<li>Az <code>upgrade</code> parancs és az <code>--install</code> kapcsoló telepít, ha nem létezik, ill. frissít, ha már létezik ilyen telepítés.</li>
</ul>
</li>
<li>
<p>Nézzük meg, hogy a Helm szerint létezik-e a release: <code>helm list</code></p>
</li>
<li>
<p>Próbáljuk ki az alkalmazást a <a href="http://localhost:32080/admin">http://localhost:32080/admin</a> címen, és vegyük észre, hogy a megrendelések automatikusan érkeznek a virtuális vásárlóktól és lezárulnak a virtuális dolgozók által.</p>
</li>
<li>
<p>A változók értékeit a values fájlból definiáljuk felül a telepítési parancsban a <code>--set</code> kapcsolóval.</p>
<div class="highlight"><pre><span></span><code>helm upgrade storeapp --install storeapp --set virtualCustomer.ordersPerHour=10 --set virtualWorker.ordersPerHour=20 --set neptun=neptun_kod
</code></pre></div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Helm chartok használata</p>
<p>Természetesen a teljes alkalmazást felkészíthetnénk helm chart alapú telepítésre, de ez most túlmutat a házi feladat keretein. A koncepció a fenti feladatból is megérthető: azzal, hogy a yaml leírók sablonozhatókká válnak, több olyan paramétert is bevezethetünk ezen az új absztrakciós szinten, amit például egy külső forrásból akarunk beállítani, így rugalmasabbá válik a konfogirációnk (pl.: CI/CD folyamatokból, környezetenként eltérő értékekre).</p>
</div>
<div class="admonition example">
<p class="admonition-title">BEADANDÓ</p>
<p>Készíts egy képernyőképet (<code>f4.1.png</code>) és commitold azt be a házi feladat repó gyökerébe, ahol az újonnan létrehozott futó pod-ok látszanak.</p>
<p>Készíts egy képernyőképet (<code>f4.2.png</code>) és commitold azt be a házi feladat repó gyökerébe, demonstrálod, hogy létrejött a helm release k8s-ben a felüldefiniált környezeti változókkal.</p>
</div>
  <hr>
  <div class="md-source-file">
    <span class="md-source-file__fact"> <span class="md-icon" title="Utolsó frissítés"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z">
          </path>
        </svg>
      </span>
      <span title="2025. szeptember 22. 09:35:59">
        <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-timeago" title="2025. szeptember 22. 09:35:59 CEST"><span class="timeago" datetime="2025-09-22T09:35:59+02:00" locale="hu"></span></span><span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_date" title="2025. szeptember 22. 09:35:59 CEST">2025-09-22</span>
      </span>
    </span>

    

    <span class="md-source-file__fact">
      <span class="md-icon" title="Szerzők">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
          <path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33.85 0 1.71.11 2.5.33 1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2Z">
          </path>
        </svg>
      </span>
      <span>Szerzők</span>
      <nav><a href="https://github.com/tibitoth" target="_blank" rel="noopener noreferrer" class="md-author" title="@tibitoth">
          <img src="https://avatars.githubusercontent.com/tibitoth?size=72" alt="@tibitoth">
        </a><a href="https://github.com/kszicsillag" target="_blank" rel="noopener noreferrer" class="md-author" title="@Gábor Simon">
          <img src="https://avatars.githubusercontent.com/u/1849897?u=1d3aa9b07d07da9a2b04d86a97ec4060c3280592&amp;v=4?size=72" alt="@Gábor Simon">
        </a><a href="https://github.com/vandreas73" target="_blank" rel="noopener noreferrer" class="md-author" title="@None">
          <img src="https://avatars.githubusercontent.com/u/113762114?u=72f34320e374884b31584a21539071340774aada&amp;v=4?size=72" alt="@None">
        </a></nav>      
    </span>
  </div>




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Vissza a tetejére
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © BME VIK AUT
    </div>
  
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.top", "search.suggest", "content.action.edit", "toc.follow", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "V\u00e1g\u00f3lapra m\u00e1solva", "clipboard.copy": "M\u00e1sol\u00e1s v\u00e1g\u00f3lapra", "search.result.more.one": "1 tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.more.other": "# tov\u00e1bbi tal\u00e1lat az oldalon", "search.result.none": "Nincs tal\u00e1lat", "search.result.one": "1 egyez\u0151 dokumentum", "search.result.other": "# egyez\u0151 dokumentum", "search.result.placeholder": "Keres\u00e9shez \u00edrj ide valamit", "search.result.term.missing": "\u00dcres", "select.version": "Verzi\u00f3v\u00e1lt\u00e1s"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="../../js/timeago.min.js"></script>
      
        <script src="../../js/timeago_mkdocs_material.js"></script>
      
        <script src="../../js/open_in_new_tab.js"></script>
      
    
  
<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(()=>{ lightbox.reload(); });
</script></body></html>